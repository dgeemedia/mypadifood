<!-- views/partials/testimonial-form.ejs -->
<section class="testimonial-form card" aria-label="Leave a testimonial">
  <h3>Share your experience</h3>
  <p class="muted">Your testimonial helps local vendors grow. Submitted testimonials are reviewed before publication.</p>

  <form method="post" action="/testimonials/submit" enctype="multipart/form-data">
    <div class="form-row">
      <label>
        Your name
        <input type="text" name="name" value="<%= (currentUser && (currentUser.name || currentUser.full_name)) ? (currentUser.name || currentUser.full_name) : '' %>" />
      </label>
    </div>

    <div class="form-row">
      <label>
        City (optional)
        <input type="text" name="city" value="" />
      </label>
    </div>

    <div class="form-row">
      <label>
        Testimonial (short)
        <textarea name="quote" rows="3" required placeholder="What did you like?"></textarea>
      </label>
    </div>

    <div class="form-row">
      <label>
        Photo (optional)
        <input type="file" name="photo" accept="image/*" />
      </label>
    </div>

    <div style="margin-top:8px">
      <% if (currentUser && currentUser.type === 'client') { %>
        <button class="btn btn-primary" type="submit">Submit testimonial</button>
      <% } else { %>
        <a class="btn btn-primary" href="/login?next=<%= encodeURIComponent(request && request.originalUrl ? request.originalUrl : '/') %>">Login to submit</a>
      <% } %>
    </div>
  </form>
</section>
