<!-- views/admin/food-orders.ejs (updated to include data attributes for admin script) -->
<h2>Food — Weekly Plans (Pending)</h2>

<% if (!plans || !plans.length) { %>
<p>No weekly plans at the moment.</p>
<% } else { %>
<table id="weeklyPlansTable" data-autorefresh="true" data-interval="30000">
  <thead>
    <tr>
      <th>ID</th>
      <th>Customer</th>
      <th>Week</th>
      <th>Plan</th>
      <th>Price (₦)</th>
      <th>Status</th>
      <th>Vendor</th>
      <th>Assigned</th>
      <th>Created</th>
      <th>Action</th>
    </tr>
  </thead>
  <tbody>
    <% plans.forEach(p => { %>
    <tr
      data-online="<%= p.client_online ? '1' : '0' %>"
      style="<%= p.assigned_admin ? '' : 'background:#f9fbff;' %>"
    >
      <td><%= p.id %></td>
      <td>
        <%= p.client_name %>
        (<%= p.client_phone %>)
      </td>
      <td>
        <%= p.week_of ? p.week_of.toISOString().slice(0,10) : p.week_of %>
      </td>
      <td><%= p.plan_type %></td>
      <td>₦<%= p.total_price %></td>
      <td><%= p.status %></td>
      <td><%= p.vendor_name || '—' %></td>
      <td><%= p.assigned_admin ? 'Yes' : 'No' %></td>
      <td><%= new Date(p.created_at).toLocaleString() %></td>
      <td>
        <a href="/admin/food-orders/<%= p.id %>">Open</a>
        <% if (!p.assigned_admin) { %>
        <form
          method="post"
          action="/admin/food-orders/<%= p.id %>/accept"
          style="display: inline"
        >
          <button type="submit">Accept</button>
        </form>
        <% } %>
      </td>
    </tr>
    <% }) %>
  </tbody>
</table>
<% } %>
